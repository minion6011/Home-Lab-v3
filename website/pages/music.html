<!DOCTYPE html>
<html lang="it">
    <head>
        <title>Music Player</title>
        <meta charset="UTF-8">
        <link rel="stylesheet" href="{{ url_for('static',filename='themes.css') }}">
        <link rel="stylesheet" href="{{ url_for('static',filename='pages/music.css') }}">
        <script src="{{ url_for('static',filename='pages/music.js') }}" type="text/javascript" defer></script>
    </head>

    <body>

        <div class="main-container" id="mainContainer" data-status="0" data-play="0">
            
            <audio style="display: none;" id="AudioPreload" preload="auto"></audio>
            <audio style="display: none;" id="AudioControll" preload="auto"></audio>
            
            <div class="library-container">
                <div class="header">
                    <p class="title">Your Library</p>

                    <button class="button" onclick="PlaylistModal('new')">
                        <img src="{{ url_for('static',filename='img/add-ico.webp')}}" class="ico-small"> Create Playlist
                    </button>

                    <div class="dropdown">
                        <button class="dropbtn">Display As &#9662;</button>
                        <div class="dropdown-content">
                            <a onclick="GridChangePlaylist('playlists-details')" data-sort="list"><img src="{{ url_for('static',filename='img/details.webp') }}" class="ico-small"> Detailed List</a>
                            <a onclick="GridChangePlaylist('playlists-grid')" data-sort="grid"><img src="{{ url_for('static',filename='img/grid.webp') }}" class="ico-small"> Detailed Grid</a>
                        </div>
                    </div>

                    <p class="title-secondary">Playlists</p>
                </div>

                <div class="playlists-grid" id="playlists-container">
                    {% for i in range(data_music["number_tot"]) %}
                        <div class="pl-item" onclick="OpenPlaylist(this)">
                            <img src='{{ data_music[(i+1)|string()]["img"] }}' class="pl-img">
                            <p class="pl-text">{{ data_music[(i+1)|string()]["name"] }}</p>
                            <input type="hidden" class="pl-id" value="{{ i+1 }}">
                        </div>
                    {% endfor %}
                </div>

            </div>

            <div class="song-container">
                <div class="playlist-songs">
                    <div class="playlist-info">
                        <input type="hidden" id="plDs-id" value="">
                        <img class="image" id="plDs-img" src="{{ url_for('static',filename='img/plDefault-ico.webp') }}">
                        <div class="text">
                            <div class="title-sep"> 
                                <p id="plDs-title">Playlist Name</p>
                                <p class="close" onclick="mainContainer.dataset.status = '0'">&#x2715;</p>
                            </div>
                            <p id="plDs-desc">Playlist Description</p>
                        </div>
                    </div>
                    <hr>
                    <div class="containerDs-butttons">
                        <button class="song-btn" onclick="PlaylistModal('edit')">
                            <img src="{{ url_for('static',filename='img/pencil-ico.webp') }}">
                        </button>
                        <button class="song-btn" onclick="deletePl()">
                            <img src="{{ url_for('static',filename='img/delete-ico.webp') }}">
                        </button>
                        <button class="song-btn" onclick="SongAddInput()">
                            <img src="{{ url_for('static',filename='img/mAdd-ico.webp') }}">
                        </button>

                        <input id="songs-input" class="songs-input" onkeydown="if (event.key === 'Enter') {AddSong()}" placeholder="YT name/link..." style="display: none;">
                    </div>
                </div>

                <table class="songs-table" id="songs-table">
                    <tr>
                        <th data-visible="0">#</th>
                        <th>Title</th>
                        <th data-visible="0">Author</th>
                        <th data-visible="0">Added</th>
                        <th data-visible="0">Duration</th>
                    </tr>
                </table>
            </div>

            <div class="player-container">
                <div class="up">
                    <div class="song-details">
                        <img id="playerImg">
                        <p id="playerTitle">Song Name</p>
                    </div>

                    <div class="music-buttons">
                        <button id="shuffle-btn" onclick="TurnShuffle()">
                            <img src="{{ url_for('static',filename='img/shuffle-ico.webp') }}">
                        </button>
                        <button onclick="FetchSong(oldSong[0]); oldSong.splice(1, 1)">
                            <img src="{{ url_for('static',filename='img/prev-ico.webp') }}">
                        </button>
                        <button onclick="StartStopAudio();">
                            <img id="play-stop-img" src="{{ url_for('static',filename='img/stop-ico.webp') }}">
                        </button>
                        <button onclick="NextSong()">
                            <img src="{{ url_for('static',filename='img/next-ico.webp') }}">
                        </button>
                        <button id="loop-btn" onclick="LoopToogle()">
                            <img src="{{ url_for('static',filename='img/loop-ico.webp') }}">
                        </button>
                    </div>

                    <div class="volume-slider">
                        <img id="mute-img" onclick="ChangeVolume(true, 0)" data-muted=0 src="{{ url_for('static',filename='img/volume-ico.webp') }}">
                        <input id="volumeRange" oninput="ChangeVolume(false, this.value)" type="range" max="1" step="0.1" value="1">
                    </div>
                </div>

                <div class="down">
                    <p id="cur-duration">0:00</p>
                    <input value=0 disabled id="playerRange" oninput="if (!this.disabled) audioControll.currentTime = this.value" type="range">
                    <p id="max-duration">0:00</p>
                </div>
            </div>

            <!-- Modal Playlist -->
            <div class="modal-playlist" id="playlist-modal">
                <div class="card">
                    <div class="title">
                        <p id="modal-pl-title">Create Playlist</p>
                        <p class="close-button" onclick="PlaylistModal('close')">âœ•</p>
                    </div>
                    <div class="items">
                        <div style="display: flex; justify-content: center;">
                            <input id="img-file" type="file" style="display: none;" accept="image/png, image/jpeg, image/webm, image/jpg, image/avif">
                            <img id="modal-pl-img" onclick="document.getElementById('img-file').click()" src="{{ url_for('static',filename='img/plDefault-ico.webp') }}" class="img-insert">
                        </div>
                        <div class="inputs">
                            <input id="pl-name" type="text" placeholder="Playlist Name" maxlength="25" class="input-field">
                            <textarea id="pl-desc" placeholder="Playlist Description" class="textarea-field" maxlength="100"></textarea>
                        </div>
                    </div>
                    <button class="button" disabled onclick="CreateEditPlaylist()" id="pl-btn">Save</button>
                </div>
            </div>
        </div>
    </body>
</html>